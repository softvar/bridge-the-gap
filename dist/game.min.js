"use strict";function J(){this.B=function(a){for(var b=0;24>b;b++)this[String.fromCharCode(97+b)]=a[b]||0;.01>this.c&&(this.c=.01),a=this.b+this.c+this.e,.18>a&&(a=.18/a,this.b*=a,this.c*=a,this.e*=a)}}function rd(a,b){return b||(b=a,a=0),Math.random()*(b-a)+a}function rp(a){return a[~~rd(a.length)]}var utils={getRandomInt:function(a,b){return Math.floor(Math.random()*(b-a+1))+a},pI:function(a){return parseInt(a,10)},clamp:function(a,b,c){return"number"!=typeof b&&(b=-(1/0)),"number"!=typeof c&&(c=1/0),Math.max(b,Math.min(c,a))},getLocalStorageData:function(a){return a?utils.pI(atob(localStorage.getItem("BridgeTheGapGameSound"))):utils.pI(atob(localStorage.getItem("BridgeTheGapHighestScore")))||0},setLocalStorageData:function(a,b){b?localStorage.setItem("BridgeTheGapGameSound",btoa(a)):localStorage.setItem("BridgeTheGapHighestScore",btoa(a))}},Bridge=function(){this.bridge=document.getElementById("bridge")};Bridge.prototype.startBuilding=function(){var a=this.bridge.style.height=0;this.bridge.className="inline-block",game.isReversedMode?this.bridge.style.left=game.sceneWidth-utils.pI(game.secondBuilding.style.width)-3+"px":this.bridge.style.left=utils.pI(game.firstBuilding.style.width)-3+"px",this.bridge.style.bottom=game.buildingHeight+"px",this.startBuildingInterval=setInterval(function(){self.bridge.style.height=a+"px",a+=2,game.isReversedMode?self.bridge.style.height=utils.clamp(utils.pI(self.bridge.style.height),0,game.sceneWidth-utils.pI(game.secondBuilding.style.width))+"px":self.bridge.style.height=utils.clamp(utils.pI(self.bridge.style.height),0,game.sceneWidth-utils.pI(game.firstBuilding.style.width))+"px"},5)},Bridge.prototype.stopBuilding=function(){clearInterval(this.startBuildingInterval),game.isReversedMode?this.bridge.className="anti-rotate-90":this.bridge.className="rotate-90"},Bridge.prototype.checkBridgePlacement=function(){var a;if(game.isReversedMode){var b=utils.pI(this.bridge.style.left)-utils.pI(this.bridge.style.height)+3,c=utils.pI(game.firstBuilding.style.left),d=utils.pI(game.firstBuilding.style.width);b>c+d?game.gameOverPosteriors():c>b?game.gameOverPosteriors():b>c+d/2-3&&c+d/2+3>b?(play("bonus"),game.scoreElement.innerHTML=utils.pI(game.scoreElement.innerHTML)+2,game.gameBonusPointElement.className="inline-block  game-bonus-point  game-bonus-point-anim",setTimeout(function(){game.gameBonusPointElement.className="game-bonus-point  hidden"},1500),game.updateHighestScore(),game.moveAhead(!0)):(game.scoreElement.innerHTML=utils.pI(game.scoreElement.innerHTML)+1,game.updateHighestScore(),a=utils.pI(game.scoreElement.innerHTML),a%game.randomReversalModeTime===0&&(game.isReversedMode=!game.isReversedMode,game.isReversedMode?game.reversedElement.className="reversed blink":game.reversedElement.className="hidden",game.randomReversalModeTime=utils.getRandomInt(1,2)),game.moveAhead())}else{var b=utils.pI(this.bridge.style.left)+utils.pI(this.bridge.style.height)+3,e=utils.pI(game.secondBuilding.style.left),f=utils.pI(game.secondBuilding.style.width);e>b?game.gameOverPosteriors():b>e+f?game.gameOverPosteriors():b>e+f/2-3&&e+f/2+3>b?(play("bonus"),game.scoreElement.innerHTML=utils.pI(game.scoreElement.innerHTML)+2,game.gameBonusPointElement.className="inline-block  game-bonus-point  game-bonus-point-anim",setTimeout(function(){game.gameBonusPointElement.className="game-bonus-point  hidden"},1500),game.updateHighestScore(),game.moveAhead(!0)):(game.scoreElement.innerHTML=utils.pI(game.scoreElement.innerHTML)+1,game.updateHighestScore(),a=utils.pI(game.scoreElement.innerHTML),a%game.randomReversalModeTime===0&&(game.isReversedMode=!game.isReversedMode,game.isReversedMode?game.reversedElement.className="reversed blink":game.reversedElement.className="hidden",game.randomReversalModeTime=utils.getRandomInt(1,2)),game.moveAhead())}};var Game=function(){this.firstBuilding=document.getElementById("first-building"),this.secondBuilding=document.getElementById("second-building"),this.secondBuildingMidSpot=document.getElementById("second-building__mid-spot"),this.secondBuildingMidSpot.className="",this.scoreElement=document.getElementsByClassName("game-score")[0],this.scoreElement.innerHTML=0,this.highestScoreElement=document.getElementsByClassName("game-highest-score")[0],this.highestScoreElement.innerHTML=utils.getLocalStorageData(),this.highestScoreBoard=document.getElementsByClassName("highest-score-board")[0],this.gameOverElement=document.getElementsByClassName("game-end")[0],this.gameRestartElement=document.getElementsByClassName("game-restart")[0],this.gameBonusPointElement=document.getElementsByClassName("game-bonus-point")[0],this.reversedElement=document.getElementById("reversed"),this.randomReversalModeTime=utils.getRandomInt(1,2),this.windoWidth=Math.max(document.documentElement.clientWidth,window.innerWidth||0),this.windowHeight=Math.max(document.documentElement.clientHeight,window.innerHeight||0),this.highestScore=utils.getLocalStorageData(),this.soundOffElement=document.getElementById("sound-off"),this.soundOnElement=document.getElementById("sound-on"),this.isSound=utils.getLocalStorageData(!0),this.isSound?(this.soundOffElement.className="hidden",this.soundOnElement.className=""):(this.soundOnElement.className="hidden",this.soundOffElement.className=""),this.minBuildingWidth=8,this.sceneWidth=500,this.buildingHeight=this.windowHeight-65-this.sceneWidth,document.getElementsByClassName("buildings")[0].style.height=this.windowHeight-65+"px"};Game.prototype.init=function(){this.addBuildings(),this.addEventListeners()},Game.prototype.addBuildings=function(a){var b;a?(b=utils.pI(this.secondBuilding.style.width),this.isReversedMode||(this.firstBuilding.style.left=0),this.firstBuilding.style.width=b+"px",this.firstBuilding.style.height=this.secondBuilding.style.height):(b=utils.getRandomInt(this.minBuildingWidth,this.sceneWidth/2),this.isReversedMode||(this.firstBuilding.style.left=0),this.firstBuilding.style.width=b+"px",this.firstBuilding.style.height=this.buildingHeight+"px");var c,d={};this.isReversedMode?(this.secondBuilding.style.left="",this.secondBuilding.style.right=0,c=utils.getRandomInt(this.minBuildingWidth,this.sceneWidth/2),this.firstBuilding.style.left=utils.getRandomInt(this.minBuildingWidth,this.sceneWidth-c-5-utils.pI(this.firstBuilding.style.width))+"px",this.firstBuilding.style.width=utils.getRandomInt(this.minBuildingWidth,this.sceneWidth-c-5),this.secondBuildingMidSpot.style.left=utils.pI(this.firstBuilding.style.left)+utils.pI(this.firstBuilding.style.width)/2-3+"px"):(d.x=utils.getRandomInt(b+5,this.sceneWidth-this.minBuildingWidth),this.secondBuilding.style.right="",this.secondBuilding.style.left=d.x+"px",c=utils.getRandomInt(this.minBuildingWidth,this.sceneWidth-d.x),this.secondBuildingMidSpot.style.left=d.x+c/2-3+"px"),this.secondBuilding.style.width=c+"px",this.secondBuilding.style.height=this.buildingHeight+"px",this.secondBuildingMidSpot.style.bottom=this.buildingHeight+"px"},Game.prototype.addEventListeners=function(){var a=new Bridge;this.mouseDown=function(b){2!==b.button&&(self.isMouseDown=!0,self.isIntroHidden||(document.getElementsByClassName("intro")[0].className="intro  anim",setTimeout(function(){document.getElementsByClassName("intro")[0].className="intro hidden",self.isIntroHidden=!0},1500)),a.startBuilding())},this.mouseUp=function(b){2!==b.button&&self.isMouseDown&&(a.stopBuilding(),game.removeEventListeners(),a.checkBridgePlacement(),self.isMouseDown=!1)};var b=document.getElementsByClassName("buildings")[0];b.addEventListener("mousedown",this.mouseDown),b.addEventListener("mouseup",this.mouseUp)},Game.prototype.removeEventListeners=function(){var a=document.getElementsByClassName("buildings")[0];a.removeEventListener("mousedown",game.mouseDown,!1),a.removeEventListener("mouseup",game.mouseUp,!1)},Game.prototype.moveAhead=function(a){a||this.isMoveAheadSoundOff||play("moveAhead"),this.isMoveAheadSoundOff=!1,setTimeout(function(){self.bridge.className="hidden",game.addBuildings(!0),game.addEventListeners()},500)},Game.prototype.gameOverPosteriors=function(){game.gameOverElement.style.display="inline",game.updateHighestScore(!0),this.removeEventListeners();var a=this;a.firstBuilding.className="shake",a.secondBuilding.className="shake",a.gameOverElement.className="game-end shake",document.getElementById("ocean").className="shake",document.getElementsByClassName("game-title")[0].className="game-title  shimmer",setTimeout(function(){this.bridge.style.height=utils.clamp(utils.pI(this.bridge.style.height),0,game.buildingHeight-1)+"px",game.isReversedMode?this.bridge.className="anti-rotate-180":this.bridge.className="rotate-180"},500),setTimeout(function(){this.bridge.className="hidden"},600),setTimeout(function(){a.firstBuilding.className="",a.secondBuilding.className="",a.gameOverElement.className="game-end",document.getElementById("ocean").className=""},500)},Game.prototype.updateHighestScore=function(a){var b=utils.getLocalStorageData(),c=game.scoreElement.innerHTML;!this.isHighestScoreSoundPlayed&&c>this.highestScore?(play("highestScore"),this.highestScoreBoard.className="game-score-board highest-score-board blink",this.isHighestScoreSoundPlayed=!0,this.isMoveAheadSoundOff=!0):a?play("gameOver"):this.highestScoreBoard.className="game-score-board highest-score-board",utils.pI(game.scoreElement.innerHTML)<b||(utils.setLocalStorageData(c),game.highestScoreElement.innerHTML=c)};var game;window.onload=function(){game=new Game,game.init(),game.gameRestartElement.addEventListener("click",function(){game.gameOverElement.style.display="none",game.reversedElement.className="hidden",document.getElementsByClassName("game-title")[0].className="game-title",game.isHighestScoreSoundPlayed=!1,game=null,game=new Game,game.init()}),game.soundOnElement.addEventListener("click",function(){game.soundOnElement.className="hidden",game.soundOffElement.className="",game.isSound=0,utils.setLocalStorageData(0,!0)}),game.soundOffElement.addEventListener("click",function(){game.soundOffElement.className="hidden",game.soundOnElement.className="",game.isSound=1,utils.setLocalStorageData(1,!0)});for(var a=document.getElementById("ocean"),b=10,c=Math.floor(500/b),d=document.createDocumentFragment(),e=0;c>e;e++){var f=document.createElement("div");f.className+=" wave",d.appendChild(f),f.style.left=e*b+"px",f.style.webkitAnimationDelay=e/100+"s"}a.appendChild(d)};var W=new function(){this.A=new J;var a,b,c,d,e,f,g,h,i,j,k,l;this.reset=function(){var a=this.A;d=100/(a.f*a.f+.001),e=100/(a.g*a.g+.001),f=1-.01*a.h*a.h*a.h,g=1e-6*-a.i*a.i*a.i,a.a||(k=.5-a.n/2,l=5e-5*-a.o),h=0<a.l?1-.9*a.l*a.l:1+10*a.l*a.l,i=0,j=1==a.m?0:2e4*(1-a.m)*(1-a.m)+32},this.D=function(){this.reset();var d=this.A;return a=1e5*d.b*d.b,b=1e5*d.c*d.c,c=1e5*d.e*d.e+10,a+b+c|0},this.C=function(m,n){var o=this.A,p=1!=o.s||o.v,q=.1*o.v*o.v,r=1+3e-4*o.w,s=.1*o.s*o.s*o.s,t=1+1e-4*o.t,u=1!=o.s,v=o.x*o.x,w=o.g,x=o.q||o.r,y=.2*o.r*o.r*o.r,z=o.q*o.q*(0>o.q?-1020:1020),A=o.p?(2e4*(1-o.p)*(1-o.p)|0)+32:0,B=o.d,C=o.j/2,D=.01*o.k*o.k,E=o.a,F=a,G=1/a,H=1/b,I=1/c,o=5/(1+20*o.u*o.u)*(.01+s);o>.8&&(o=.8);for(var J,K,L,M,N,o=1-o,O=!1,P=0,Q=0,R=0,S=0,T=0,U=0,V=0,W=0,X=0,Y=0,Z=Array(1024),$=Array(32),_=Z.length;_--;)Z[_]=0;for(_=$.length;_--;)$[_]=2*Math.random()-1;for(_=0;n>_;_++){if(O)return _;if(A&&++X>=A&&(X=0,this.reset()),j&&++i>=j&&(j=0,d*=h),f+=g,d*=f,d>e&&(d=e,w>0&&(O=!0)),K=d,C>0&&(Y+=D,K*=1+Math.sin(Y)*C),K|=0,8>K&&(K=8),E||(k+=l,0>k?k=0:k>.5&&(k=.5)),++Q>F)switch(Q=0,++P){case 1:F=b;break;case 2:F=c}switch(P){case 0:R=Q*G;break;case 1:R=1+2*(1-Q*H)*B;break;case 2:R=1-Q*I;break;case 3:R=0,O=!0}x&&(z+=y,L=0|z,0>L?L=-L:L>1023&&(L=1023)),p&&r&&(q*=r,1e-5>q?q=1e-5:q>.1&&(q=.1)),N=0;for(var aa=8;aa--;){if(V++,V>=K&&(V%=K,3==E))for(J=$.length;J--;)$[J]=2*Math.random()-1;switch(E){case 0:M=k>V/K?.5:-.5;break;case 1:M=1-2*(V/K);break;case 2:M=V/K,M=M>.5?6.28318531*(M-1):6.28318531*M,M=0>M?1.27323954*M+.405284735*M*M:1.27323954*M-.405284735*M*M,M=0>M?.225*(M*-M-M)+M:.225*(M*M-M)+M;break;case 3:M=$[Math.abs(32*V/K|0)]}p&&(J=U,s*=t,0>s?s=0:s>.1&&(s=.1),u?(T+=(M-U)*s,T*=o):(U=M,T=0),U+=T,S+=U-J,M=S*=1-q),x&&(Z[W%1024]=M,M+=Z[(W-L+1024)%1024],W++),N+=M}N=.125*N*R*v,m[_]=N>=1?32767:-1>=N?-32768:32767*N|0}return n}};window.jsfxr=function(a){W.A.B(a);var b=W.D();a=new Uint8Array(4*((b+1)/2|0)+44);var b=2*W.C(new Uint16Array(a.buffer,44),b),c=new Uint32Array(a.buffer,0,44);c[0]=1179011410,c[1]=b+36,c[2]=1163280727,c[3]=544501094,c[4]=16,c[5]=65537,c[6]=44100,c[7]=88200,c[8]=1048578,c[9]=1635017060,c[10]=b;for(var b=b+44,c=0,d="data:audio/wav;base64,";b>c;c+=3)var e=a[c]<<16|a[c+1]<<8|a[c+2],d=d+("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e>>18]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e>>12&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e>>6&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[63&e]);return c-=b,d.slice(0,d.length-c)+"==".slice(0,c)};var sounds={},soundEffect=function(a,b){sounds[a]=[],b.forEach(function(b){var c=new Audio;c.src=jsfxr(b),sounds[a].push(c)})},play=function(a){console.log(game.isSound),game.isSound&&sounds[a]&&rp(sounds[a]).play()};soundEffect("gameOver",[[2,.2,.01,,.83,.24,,,,.62,.6,,,.1248,.4522,,,,.4,,,,,1]]),soundEffect("moveAhead",[[2,,.2,,.1753,.64,,-.5261,,,,,,.5522,-.564,,,,1,,,,,1]]),soundEffect("highestScore",[[0,,.016,.4953,.3278,.6502,,,,,,.4439,.6322,,,,,,1,,,,,1]]),soundEffect("bonus",[[0,,.01,.4911,.4105,.5077,,,,,,.2117,.6579,,,,,,1,,,,,1]]);